---

title: CustomClientData


keywords: fastai
sidebar: home_sidebar

summary: "Create custom TFF ClientData from Pandas Dataframe"
description: "Create custom TFF ClientData from Pandas Dataframe"
nb_path: "00_customclientdata.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_customclientdata.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-12-23 12:36:29.882993: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>input</em></strong>: none / raw data</p>
<p><strong><em>output</em></strong>: function for creating custom tff ClientData</p>
<p><strong><em>description:</em></strong></p>
<p>In this notebook we generate customer path data, and transform it into tensorflow federated <a href="https://www.tensorflow.org/federated/tutorials/working_with_client_data">ClientData</a> format.
You can edit the code to load and clean and transform your own client path data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Import-relevant-modules">Import relevant modules<a class="anchor-link" href="#Import-relevant-modules"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Uncomment the following cell to run with the newest version of tff</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># can causes a duplicate tensorboard install, leading to errors.</span>
<span class="c1">#!pip uninstall --yes tensorboard tb-nightly</span>

<span class="c1">#!pip install --quiet --upgrade tensorflow-federated-nightly</span>
<span class="c1">#!pip install --quiet --upgrade nest-asyncio</span>
<span class="c1">#!pip install --quiet --upgrade tb-nightly  # or tensorboard, but not both</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pyarrow</span> <span class="kn">import</span> <span class="n">feather</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">softmax</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-notebook-parameters">Define notebook parameters<a class="anchor-link" href="#Define-notebook-parameters"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">SHUFFLE_BUFFER</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">NUM_EPOCHS</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">n_customers</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># number of customers (paths, assuming only one path per customer)</span>
<span class="n">max_path_length</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># limit simulation length</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define any immediate derivative operations from the parameters:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="(or-alternatively-load-your-own-data-and-turn-it-into-an-applicable-format)">(or alternatively load your own data and turn it into an applicable format)<a class="anchor-link" href="#(or-alternatively-load-your-own-data-and-turn-it-into-an-applicable-format)"> </a></h2><p>Try for example: <a href="https://cseweb.ucsd.edu/~jmcauley/datasets.html">https://cseweb.ucsd.edu/~jmcauley/datasets.html</a></p>
<p>or <a href="https://archive.ics.uci.edu/ml/datasets/Entree+Chicago+Recommendation+Data">https://archive.ics.uci.edu/ml/datasets/Entree+Chicago+Recommendation+Data</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">zipfile</span><span class="o">,</span> <span class="nn">io</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;raw_data&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="s2">&quot;customer-journey-unil-ch-datasets&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>  <span class="c1"># check if already loaded</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;http://customer-journey.me/wp-content/uploads/2018/02/customer-journey-unil-ch-datasets.zip&quot;</span>
    <span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
    <span class="n">z</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filepaths</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">p</span>
    <span class="o">/</span> <span class="s2">&quot;customer-journey-unil-ch-datasets&quot;</span>
    <span class="o">/</span> <span class="s2">&quot;csv&quot;</span>
    <span class="o">/</span> <span class="s2">&quot;configuration6&quot;</span>
    <span class="o">/</span> <span class="s2">&quot;excluding-solution&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.csv&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">read_csv_list_to_df</span><span class="p">(</span><span class="n">filepaths</span><span class="p">):</span>
    <span class="n">max_trace_id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filepaths</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">trace_id</span> <span class="o">+=</span> <span class="n">max_trace_id</span>  <span class="c1"># user id count begins from 0 at each file</span>
        <span class="n">max_trace_id</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">trace_id</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">read_csv_list_to_df</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trace_id</th>
      <th>activities</th>
      <th>owner</th>
      <th>employed</th>
      <th>age</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>activity_09</td>
      <td>no</td>
      <td>yes</td>
      <td>20-39yo</td>
      <td>high</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>activity_04</td>
      <td>no</td>
      <td>yes</td>
      <td>20-39yo</td>
      <td>high</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>activity_02</td>
      <td>no</td>
      <td>yes</td>
      <td>20-39yo</td>
      <td>high</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>activity_09</td>
      <td>no</td>
      <td>yes</td>
      <td>60-79yo</td>
      <td>high</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>activity_04</td>
      <td>no</td>
      <td>yes</td>
      <td>60-79yo</td>
      <td>high</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4298</th>
      <td>4994</td>
      <td>activity_07</td>
      <td>yes</td>
      <td>no</td>
      <td>40-59yo</td>
      <td>middle</td>
    </tr>
    <tr>
      <th>4299</th>
      <td>4994</td>
      <td>activity_08</td>
      <td>yes</td>
      <td>no</td>
      <td>40-59yo</td>
      <td>middle</td>
    </tr>
    <tr>
      <th>4300</th>
      <td>4994</td>
      <td>activity_09</td>
      <td>yes</td>
      <td>no</td>
      <td>40-59yo</td>
      <td>middle</td>
    </tr>
    <tr>
      <th>4301</th>
      <td>4995</td>
      <td>activity_10</td>
      <td>yes</td>
      <td>yes</td>
      <td>60-79yo</td>
      <td>middle</td>
    </tr>
    <tr>
      <th>4302</th>
      <td>4995</td>
      <td>activity_06</td>
      <td>yes</td>
      <td>yes</td>
      <td>60-79yo</td>
      <td>middle</td>
    </tr>
  </tbody>
</table>
<p>21521 rows × 6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>trace_id      4996
activities      15
owner            2
employed         2
age              5
income           3
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">activities</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;activity_09&#39;, &#39;activity_04&#39;, &#39;activity_02&#39;, &#39;activity_10&#39;,
       &#39;activity_06&#39;, &#39;activity_03&#39;, &#39;activity_07&#39;, &#39;activity_08&#39;,
       &#39;activity_01&#39;, &#39;activity_05&#39;, &#39;noise_2&#39;, &#39;noise_0&#39;, &#39;noise_4&#39;,
       &#39;noise_3&#39;, &#39;noise_1&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;20-39yo&#39;, &#39;60-79yo&#39;, &#39;0-19yo&#39;, &#39;40-59yo&#39;, &#39;80yo+&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">income</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;high&#39;, &#39;middle&#39;, &#39;low&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">trace_id</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">trace_id</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">activities</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">activities</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="s2">&quot;yes&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">employed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">employed</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="s2">&quot;yes&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;0-19yo&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;20-39yo&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;40-59yo&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;60-79yo&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;80yo+&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">income</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">income</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;action_index&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>action_index</th>
      <th>trace_id</th>
      <th>activities</th>
      <th>owner</th>
      <th>employed</th>
      <th>age</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>activity_09</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>activity_04</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>activity_02</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>activity_09</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1</td>
      <td>activity_04</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21516</th>
      <td>4298</td>
      <td>4994</td>
      <td>activity_07</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21517</th>
      <td>4299</td>
      <td>4994</td>
      <td>activity_08</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21518</th>
      <td>4300</td>
      <td>4994</td>
      <td>activity_09</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21519</th>
      <td>4301</td>
      <td>4995</td>
      <td>activity_10</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>21520</th>
      <td>4302</td>
      <td>4995</td>
      <td>activity_06</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>21521 rows × 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we need extra category for denoting that client activity has stopped</span>
<span class="n">activity_ended</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;activity_</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">activities</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">activities</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">activities</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">([</span><span class="n">activity_ended</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>order of events for customer</p>
</li>
<li><p>next and previous event</p>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;action_index&#39;, &#39;trace_id&#39;, &#39;activities&#39;, &#39;owner&#39;, &#39;employed&#39;, &#39;age&#39;,
       &#39;income&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s2">&quot;action_index&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prev_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;employed&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;income&quot;</span><span class="p">:</span> <span class="s2">&quot;uint8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;next_activity&quot;</span><span class="p">:</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_data</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;trace_id&quot;</span><span class="p">):</span>
    <span class="n">client_data</span><span class="o">.</span><span class="n">action_index</span> <span class="o">-=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">action_index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">client_data</span><span class="o">.</span><span class="n">action_index</span> <span class="o">=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">action_index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># rename columns</span>
    <span class="n">buf_df</span> <span class="o">=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;trace_id&quot;</span><span class="p">:</span> <span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;activities&quot;</span><span class="p">:</span> <span class="s2">&quot;prev_activity&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="c1"># add new column for next activity</span>
    <span class="n">buf_df</span><span class="p">[</span><span class="s2">&quot;next_activity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">activities</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span>
        <span class="n">periods</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">activity_ended</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
    <span class="c1"># add buffer to prev_next_df</span>
    <span class="n">prev_next_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">prev_next_df</span><span class="p">,</span> <span class="n">buf_df</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>client_id</th>
      <th>action_index</th>
      <th>prev_activity</th>
      <th>owner</th>
      <th>employed</th>
      <th>age</th>
      <th>income</th>
      <th>next_activity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>activity_09</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>activity_04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>activity_04</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>activity_02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2</td>
      <td>activity_02</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>activity_16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>activity_09</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>activity_04</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>activity_04</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>activity_02</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21516</th>
      <td>4994</td>
      <td>2</td>
      <td>activity_07</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>activity_08</td>
    </tr>
    <tr>
      <th>21517</th>
      <td>4994</td>
      <td>3</td>
      <td>activity_08</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>activity_09</td>
    </tr>
    <tr>
      <th>21518</th>
      <td>4994</td>
      <td>4</td>
      <td>activity_09</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>activity_16</td>
    </tr>
    <tr>
      <th>21519</th>
      <td>4995</td>
      <td>0</td>
      <td>activity_10</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>activity_06</td>
    </tr>
    <tr>
      <th>21520</th>
      <td>4995</td>
      <td>1</td>
      <td>activity_06</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>activity_16</td>
    </tr>
  </tbody>
</table>
<p>21521 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grouped_by_action_count</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()[[</span><span class="s2">&quot;action_index&quot;</span><span class="p">]]</span>
<span class="n">clients_to_be_dropped</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">grouped_by_action_count</span><span class="p">[</span><span class="n">grouped_by_action_count</span><span class="o">.</span><span class="n">action_index</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
<span class="p">)</span>
<span class="c1"># clients_to_be_dropped.to_numpy()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clients_to_be_dropped</span><span class="p">)</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">prev_next_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">client_id</span> <span class="ow">in</span> <span class="n">clients_to_be_dropped</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="o">.</span><span class="n">index</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span>
<span class="n">prev_next_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">outliers</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Int64Index([999, 1998, 2997, 3996], dtype=&#39;int64&#39;, name=&#39;client_id&#39;)
Int64Index([ 4295,  4296,  4297,  4298,  4299,  4300,  4301,  4302,  8592,
             8593,  8594,  8595,  8596,  8597,  8598,  8599,  8600,  8601,
            12881, 12882, 12883, 12884, 12885, 12886, 12887, 12888, 17213,
            17214, 17215, 17216, 17217, 17218, 17219],
           dtype=&#39;int64&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>client_id        4992
action_index       11
prev_activity      15
owner               1
employed            1
age                 5
income              3
next_activity      16
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Drop uninformative columns that only contain one value</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;owner&quot;</span><span class="p">,</span> <span class="s2">&quot;employed&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span><span class="p">[</span><span class="s2">&quot;action_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="o">.</span><span class="n">action_index</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;action_count&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;income&quot;</span><span class="p">]):</span>
    <span class="n">prev_next_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">tick</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;results/client_histograms.png&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok, so most clients have from 3 to 5 actions (including end of journey). considering background information, all groups are well represented.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># convert state feature into one hot</span>
<span class="n">onehot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">prev_next_df</span><span class="o">.</span><span class="n">prev_activity</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;prev&quot;</span><span class="p">)</span>
<span class="n">prev_next_df</span><span class="p">[</span><span class="n">onehot</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">onehot</span>
<span class="n">prev_next_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;prev_activity&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># convert label categories into numerical format</span>
<span class="c1"># (this is because for the moment TFF does not support multi-output models)</span>
<span class="n">prev_next_df</span><span class="p">[[</span><span class="s2">&quot;next_activity&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="p">[[</span><span class="s2">&quot;next_activity&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
<span class="p">)</span>
<span class="n">prev_next_df</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>client_id           int64
action_index        int64
age                 int64
income              int64
next_activity       int64
action_count        int64
prev_activity_01    int64
prev_activity_02    int64
prev_activity_03    int64
prev_activity_04    int64
prev_activity_05    int64
prev_activity_06    int64
prev_activity_07    int64
prev_activity_08    int64
prev_activity_09    int64
prev_activity_10    int64
prev_noise_0        int64
prev_noise_1        int64
prev_noise_2        int64
prev_noise_3        int64
prev_noise_4        int64
prev_activity_16    int64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prev_next_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>client_id</th>
      <th>action_index</th>
      <th>age</th>
      <th>income</th>
      <th>next_activity</th>
      <th>action_count</th>
      <th>prev_activity_01</th>
      <th>prev_activity_02</th>
      <th>prev_activity_03</th>
      <th>prev_activity_04</th>
      <th>...</th>
      <th>prev_activity_07</th>
      <th>prev_activity_08</th>
      <th>prev_activity_09</th>
      <th>prev_activity_10</th>
      <th>prev_noise_0</th>
      <th>prev_noise_1</th>
      <th>prev_noise_2</th>
      <th>prev_noise_3</th>
      <th>prev_noise_4</th>
      <th>prev_activity_16</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>15</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21516</th>
      <td>4994</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21517</th>
      <td>4994</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21518</th>
      <td>4994</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>15</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21519</th>
      <td>4995</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21520</th>
      <td>4995</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>15</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>21488 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We need to convert the data into untidy nested format for TFF</span>
<span class="c1"># so that x is a vector and y is a scalar</span>
<span class="n">cxy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>
<span class="n">cxy_df</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="o">.</span><span class="n">client_id</span>
<span class="n">cxy_df</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="p">[</span>
    <span class="n">prev_next_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;next_activity&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cxy_df</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">prev_next_df</span><span class="o">.</span><span class="n">next_activity</span>

<span class="n">cxy_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>client_id</th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>[0, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>[1, 1, 2, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, ...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>[2, 1, 2, 3, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>[0, 3, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ...</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>[1, 3, 2, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, ...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>21516</th>
      <td>4994</td>
      <td>[2, 2, 1, 3, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...</td>
      <td>7</td>
    </tr>
    <tr>
      <th>21517</th>
      <td>4994</td>
      <td>[3, 2, 1, 4, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, ...</td>
      <td>8</td>
    </tr>
    <tr>
      <th>21518</th>
      <td>4994</td>
      <td>[4, 2, 1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, ...</td>
      <td>15</td>
    </tr>
    <tr>
      <th>21519</th>
      <td>4995</td>
      <td>[0, 3, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...</td>
      <td>5</td>
    </tr>
    <tr>
      <th>21520</th>
      <td>4995</td>
      <td>[1, 3, 1, 2, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
<p>21488 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-data-for-further-use">Save data for further use<a class="anchor-link" href="#Save-data-for-further-use"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">feather</span><span class="o">.</span><span class="n">write_feather</span><span class="p">(</span><span class="n">cxy_df</span><span class="p">,</span> <span class="s2">&quot;data/preprocessed_data/data.f&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-function-to-convert-df-into-tff-ClientData">Create function to convert df into tff ClientData<a class="anchor-link" href="#Create-function-to-convert-df-into-tff-ClientData"> </a></h2><p>Following this discussion: <a href="https://stackoverflow.com/questions/58965488/how-to-create-federated-dataset-from-a-csv-file">https://stackoverflow.com/questions/58965488/how-to-create-federated-dataset-from-a-csv-file</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_tff_client_data_from_df" class="doc_header"><code>create_tff_client_data_from_df</code><a href="https://github.com/City-of-Helsinki/ml_federated_customer_journey/tree/master/ml_federated_customer_journey/customclientdata.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_tff_client_data_from_df</code>(<strong><code>df</code></strong>, <strong><code>client_id_col</code></strong>=<em><code>'client_id'</code></em>, <strong><code>sample_size</code></strong>=<em><code>1.0</code></em>, <strong><code>shuffle_buffer</code></strong>=<em><code>100</code></em>, <strong><code>batch_size</code></strong>=<em><code>32</code></em>, <strong><code>num_epochs</code></strong>=<em><code>20</code></em>, <strong><code>prefetch_buffer</code></strong>=<em><code>100</code></em>, <strong><code>shuffle_seed</code></strong>=<em><code>42</code></em>)</p>
</blockquote>
<p>turn pd dataframe into tff client dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test (well, at least it should not crash)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tff_data</span> <span class="o">=</span> <span class="n">create_tff_client_data_from_df</span><span class="p">(</span><span class="n">cxy_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-12-23 11:41:39.523696: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-12-23 11:41:39.783200: E tensorflow/stream_executor/cuda/cuda_driver.cc:328] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2021-12-23 11:41:39.783253: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (ml-nuutti-1a-m-mem): /proc/driver/nvidia/version does not exist
2021-12-23 11:41:39.785298: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tff_data</span><span class="o">.</span><span class="n">create_tf_dataset_for_client</span><span class="p">(</span><span class="n">tff_data</span><span class="o">.</span><span class="n">client_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;PrefetchDataset shapes: OrderedDict([(x, (None, 20)), (y, (None,))]), types: OrderedDict([(x, tf.int64), (y, tf.int32)])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">tff</span><span class="o">.</span><span class="n">simulation</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">ClientData</span><span class="o">.</span><span class="n">train_test_client_split</span><span class="p">(</span>
    <span class="n">tff_data</span><span class="p">,</span> <span class="mi">500</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-12-23 11:41:39.966178: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2021-12-23 11:41:39.966611: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2095190000 Hz
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

